colnames(q2.tb1)[5:6] <- c("cross-entroy", "n.iter")
q2.tb1
for (i in 1:5){
q2.out.inits[[i]] <- sgd_class(q2.x, q2.y, unlist(inits[i, ]))
}
q2.tb1 <- cbind(t(sapply(q2.out.inits, "[[", 1)),
sapply(q2.out.inits, "[[", 6),
sapply(q2.out.inits, "[[", 2))
rownames(q2.tb1) <- c("(0.4, 0.45, -0.35, 0.25)",
"(20, 20, 20, 20)",
"(-20, -20, -20, -20)",
"(0, 0, 0, 0)",
"(0.3, 0.6, -0.3, 0.2)")
colnames(q2.tb1)[5:6] <- c("cross-entroy", "n.iter")
q2.tb1
library(caret)
init <- c(theta0 = 0.3, theta1 = 0.6, theta2 = -0.3, theta3 = 0.2)
alpha <- seq(0.1, 0.9, 0.1)
q2.out.alphas <- list()
for (i in 1:5){
q2.out.alphas[[i]] <- sgd_class(q2.x, q2.y, init, init, alpha = alpha[i])
}
for (i in 1:5){
q2.out.alphas[[i]] <- sgd_class(q2.x, q2.y, init, init, alpha = alpha[i])
}
q2.out.alphas <- list()
q2.out.alphas[[1]] <- sgd(q2.x, q2.y, init, alpha = alpha[1])
q2.out.alphas[[1]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[1])
q2.out.alphas[[2]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[2])
q2.out.alphas[[3]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[3])
q2.out.alphas[[4]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[4])
q2.out.alphas[[5]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[5])
q2.out.alphas[[6]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[6])
q2.out.alphas[[7]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[7])
q2.out.alphas[[8]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[8])
q2.out.alphas[[9]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[9])
q2.tb2 <- cbind(t(sapply(q2.out.alphas, "[[", 1)),
sapply(q2.out.alphas, "[[", 6),
sapply(q2.out.alphas, "[[", 2))
rownames(q2.tb2) <- paste("alpha=",as.character(alpha), sep = "")
colnames(q2.tb2)[5:6] <- c("SSE", "n.iter")
q2.tb2
m <- c(1, 10, 100, 200, 500, 1000)
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd(q2.x, q2.y, exprs, init, alpha = 0.9, m = m[1])
function(x, y, expr, param_list){ # object function
x_pos <- length(param_list) + 1
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, exprs, init, alpha = 0.9, m = m[1])
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.alphas[[1]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[1])
q2.out.alphas[[2]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[2])
q2.out.alphas[[3]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[3])
q2.out.alphas[[4]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[4])
q2.out.alphas[[5]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[5])
q2.out.alphas[[6]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[6])
q2.out.alphas[[7]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[7])
q2.out.alphas[[8]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[8])
q2.out.alphas[[9]] <- sgd_class(q2.x, q2.y, init, alpha = alpha[9])
q2.tb2 <- cbind(t(sapply(q2.out.alphas, "[[", 1)),
sapply(q2.out.alphas, "[[", 6),
sapply(q2.out.alphas, "[[", 2))
rownames(q2.tb2) <- paste("alpha=",as.character(alpha), sep = "")
colnames(q2.tb2)[5:6] <- c("SSE", "n.iter")
m <- c(1, 10, 100, 200, 500, 1000)
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.ms[[2]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[2])
q2.out.ms[[3]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[3])
q2.out.ms[[4]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[4])
q2.out.ms[[5]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[5])
q2.out.ms[[6]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[6])
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.ms[[2]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[2])
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
x %*% theta
ff <- 1/(1+exp(-x %*% theta))
t((y - ff)/(ff*(1-ff) + 1e-9))
x[,i]
m <- c(10, 100, 200, 500)
q2.out.ms <- list()
m <- c(10, 100, 200, 500)
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[2])
q2.out.ms[[2]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[3])
q2.out.ms[[3]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[4])
q2.out.ms[[4]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[5])
function (n, size = n, replace = FALSE, prob = NULL)
m <- c(10, 100, 200, 500)
q2.out.ms <- list()
q2.out.ms[[1]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[1])
q2.out.ms[[2]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[2])
q2.out.ms[[3]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[3])
q2.out.ms[[4]] <- sgd_class(q2.x, q2.y, init, alpha = 0.9, m = m[4])
q2.tb3 <- cbind(t(sapply(q2.out.ms, "[[", 1)),
sapply(q2.out.ms, "[[", 6),
sapply(q2.out.ms, "[[", 2))
rownames(q2.tb3) <- paste("m=",as.character(m), sep = "")
colnames(q2.tb3)[5:6] <- c("SSE", "n.iter")
q2.tb3
rmsprop <- function(x, y, inits, alpha = 0.5 , m = length(y)/5, rho = 0.9,
phi = 0.5, v = numeric(length(inits)), maxit = 1e5,
eps1 = 1e-6, eps2 = 1e-3){
thetas <- inits
k <- 0
r <- numeric(length(thetas))
obj_last <- cost(x, y, thetas)
g_history <- c(0, 0, 0, 0)
theta_history <- thetas
obj_history <- obj_last
while(TRUE){
sample_ind <- sample(1:500, m)
thetas <- thetas + phi * v
g <- grad_class(x[sample_ind, ],
y[sample_ind, ],
thetas)
r <- rho * r + (1 - rho) * g^2
v <- phi * v - alpha/sqrt(r) * g
if (sum(v^2) <= eps1) break
thetas <- thetas + v
obj_cur <- cost(x, y, thetas)
if (abs(obj_cur - obj_last)/obj_last < eps2){
thetas <- thetas - v
break
}
obj_last <- obj_cur
k <- k + 1
print(k)
g_history <- rbind(g_history, t(g))
obj_history <- c(obj_history, obj_last)
theta_history <- cbind(theta_history, thetas)
if (n >= maxit) break
}
return(list(theta = thetas, iter = k, obj_history = obj_history,
g_history = g_history, theta_history = theta_history,
obj_last = obj_last, r, v))
}
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
rmsprop <- function(x, y, inits, alpha = 0.5 , m = length(y)/5, rho = 0.9,
phi = 0.5, v = numeric(length(inits)), maxit = 1e5,
eps1 = 1e-6, eps2 = 1e-3){
thetas <- inits
k <- 0
r <- numeric(length(thetas))
obj_last <- cost(x, y, thetas)
g_history <- c(0, 0, 0, 0)
theta_history <- thetas
obj_history <- obj_last
while(TRUE){
sample_ind <- sample(1:500, m)
thetas <- thetas + phi * v
g <- grad_class(x[sample_ind, ],
y[sample_ind, ],
thetas)
r <- rho * r + (1 - rho) * g^2
v <- phi * v - alpha/sqrt(r) * g
if (sum(v^2) <= eps1) break
thetas <- thetas + v
obj_cur <- cost(x, y, thetas)
if (abs(obj_cur - obj_last)/obj_last < eps2){
thetas <- thetas - v
break
}
obj_last <- obj_cur
k <- k + 1
#                 print(k)
g_history <- rbind(g_history, t(g))
obj_history <- c(obj_history, obj_last)
theta_history <- cbind(theta_history, thetas)
if (n >= maxit) break
}
return(list(theta = thetas, iter = k, obj_history = obj_history,
g_history = g_history, theta_history = theta_history,
obj_last = obj_last, r, v))
}
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9 , m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
q2.tb3
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.5, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
ttt <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100, rho = 0.9,
phi = 0.5, maxit = 1e4)
ttt[[6]]
ttt[[2]]
ttt[[1]]
q2.tb3 <- cbind(t(sapply(q2.out.ms, "[[", 1)),
sapply(q2.out.ms, "[[", 6),
sapply(q2.out.ms, "[[", 2))
rownames(q2.tb3) <- paste("m=",as.character(m), sep = "")
colnames(q2.tb3)[5:6] <- c("cross-entroy", "n.iter")
q2.tb2 <- cbind(t(sapply(q2.out.alphas, "[[", 1)),
sapply(q2.out.alphas, "[[", 6),
sapply(q2.out.alphas, "[[", 2))
rownames(q2.tb2) <- paste("alpha=",as.character(alpha), sep = "")
colnames(q2.tb2)[5:6] <- c("cross-entroy", "n.iter")
q2.out.rmsprops <- list()
for (i in 1:10){
q2.out.rmsprops[[i]] <- rmsprop(q2.x, q2.y, init, alpha = 0.9, m = 100,
rho = 0.9, phi = 0.5, maxit = 1e4)
}
q2.tb4 <- cbind(1:10,
t(sapply(q2.out.rmsprops, "[[", 1)),
sapply(q2.out.rmsprops, "[[", 6),
sapply(q2.out.rmsprops, "[[", 2))
colnames(q2.tb4)[c(1,6:7)] <- c("#", "SSE", "n.iter")
q2.tb4
q1.tb3
cbind(q1.out.ms[[4]][[1]],
q1.out.ms[[4]][[6]],
q1.out.ms[[4]][[2]])
cbind(t(q1.out.ms[[4]][[1]]),
q1.out.ms[[4]][[6]],
q1.out.ms[[4]][[2]])
rbind(cbind(t(q1.out.ms[[4]][[1]]),
q1.out.ms[[4]][[6]],
q1.out.ms[[4]][[2]]),
cbind(t(sapply(q1.out.sgdm, "[[", 1)),
sapply(q1.out.sgdm, "[[", 6),
sapply(q1.out.sgdm, "[[", 2)),
cbind(t(q1.out.adasgd[[4]][[1]]),
q1.out.adasgd[[4]][[6]],
q1.out.adasgd[[4]][[2]]))
cbind(t(sapply(q1.out.sgdm, "[[", 1)),
sapply(q1.out.sgdm, "[[", 6),
sapply(q1.out.sgdm, "[[", 2))
cbind(t(q1.out.adasgd[[4]][[1]]),
q1.out.adasgd[[4]][[6]],
q1.out.adasgd[[4]][[2]])
t(q1.out.adasgd[[4]][[1]]
)
rbind(cbind(t(q1.out.ms[[4]][[1]]),
q1.out.ms[[4]][[6]],
q1.out.ms[[4]][[2]]),
cbind(t(sapply(q1.out.sgdm, "[[", 1)),
sapply(q1.out.sgdm, "[[", 6),
sapply(q1.out.sgdm, "[[", 2)),
cbind(t(q1.out.adasgd[[1]]),
q1.out.adasgd[[6]],
q1.out.adasgd[[2]]))
colnames(q1.tb4)[5:6] <- c("SSE", "n.iter")
rownames(q1.tb4) <- c("SGD", "SGD with momentum(0.1)",
"SGD with momentum(0.5)", "SGD with momentum(0.9)",
"AdaSGD")
q1.tb4 <- rbind(cbind(t(q1.out.ms[[4]][[1]]),
q1.out.ms[[4]][[6]],
q1.out.ms[[4]][[2]]),
cbind(t(sapply(q1.out.sgdm, "[[", 1)),
sapply(q1.out.sgdm, "[[", 6),
sapply(q1.out.sgdm, "[[", 2)),
cbind(t(q1.out.adasgd[[1]]),
q1.out.adasgd[[6]],
q1.out.adasgd[[2]]))
colnames(q1.tb4)[5:6] <- c("SSE", "n.iter")
rownames(q1.tb4) <- c("SGD", "SGD with momentum(0.1)",
"SGD with momentum(0.5)", "SGD with momentum(0.9)",
"AdaSGD")
q1.tb4
save(list = ls(), file = "./hw1output.RData")
kable(q1.tb3, digits = 3)
kable(q1.tb2, digits = 3)
colnames(q2.tb4)[c(1,6:7)] <- c("#", "cross-entroy", "n.iter")
save(list = ls(), file = "./hw1output.RData")
getwd()
